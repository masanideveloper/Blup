<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-image: url('https://i.postimg.cc/pTH0Y5sp/Rectangle-8610.png');
      background-size: cover;
      font-family: 'Arial', sans-serif;
      text-align: center;
    }

    .balance-label {
      display: inline-block;
      padding: 5px 5px;
      font-size: 25px;
      border-radius: 10px;
      color: #964B00;
      cursor: pointer;
      position: relative;
    }

    .balance-header {
      background-image: url('https://i.postimg.cc/xTHsXRfL/Rectangle-8606.png');
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      padding: 5px;
      margin: 30px;
      z-index: 100;
      color: #964B00;
      font-size: 25px;
      font-weight: bold;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
    }

    .image-container {
      margin: 30px auto;
      width: 300px;
      height: 300px;
      border-radius: 50%;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }

    .image-container:hover {
      transform: scale(1.05);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.5);
    }

    .image-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: -150%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0) 100%);
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      0% {
        left: -150%;
      }
      100% {
        left: 150%;
      }
    }

    .fly-out {
      position: absolute;
      color: #fff;
      font-size: 40px;
      font-style: bold;
      animation: fly 3s forwards;
    }

    @keyframes fly {
      0% {
        opacity: 100%;
        transform: translateY(-100px);
      }
      100% {
        opacity: 100px;
        transform: translateY(-600px);
      }
    }

    /* Responsive Progress Bar */
    .progress-container {
      margin-top: 60px;
      width: 80%;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }

    .progress {
      height: 32px;
      border-radius: 5px;
      background-color: #fff;
      position: relative;
      overflow: hidden;
      width: 100%;
    }

    .progress-bar {
      height: 100%;
      background-color: #ff0000;
      border-radius: 5px;
      transition: width 0.8s ease;
    }

    .progress-text {
      position: absolute;
      width: 100%;
      top: 5px;
      left: 0;
      font-family: Sans-Serif;
      font-size: 16px;
      font-weight: bold;
      text-align: center;
      color: #000;
    }

    .progress::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to left, rgba(255,255,255,0) 0%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0) 100%);
      animation: shimmer 1.8s infinite;
    }

    @keyframes shimmer {
      0% {
        left: 0%;
      }
      100% {
        left: -150%;
      }
    }

    /* Countdown Styling */
    .countdown-timer {
      margin-top: 15px;
      text-align: center;
      font-size: 20px;
      color: #964B00;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    .footer-nav {
      position: fixed;
      background-image: url('https://i.postimg.cc/cCb9xWQ3/image.png');
      bottom: 0;
      background-size: cover;
      width: 100%;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 10px;
      border-radius: 20px;
      box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
    }

    .footer-nav img {
      width: 80px;
      height: 80px;
      transition: all 0.2s ease-in-out;
      opacity: 0.7;
    }

    .footer-nav img:hover {
      opacity: 1;
    }

    .footer-nav img.active {
      transform: scale(1.5);
      opacity: 1;
      border-radius: 30px;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.6);
    }
  </style>
</head>
<body>

  <!-- Balance Section -->
  <div class="balance-header">
    Balance: <span class="balance-label" id="balance">0</span>
  </div>

  <!-- Image with shimmer and click effects -->
  <div class="image-container" id="imageContainer">
    <img src="https://i.postimg.cc/Hxg6TCgR/Background-Eraser-20240922-083106402.png" alt="Image">
  </div>

  <!-- Progress Bar Section -->
  <div class="progress-container">
    <div class="progress">
      <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
      <div class="progress-text" id="progressText">
        0 / 100
      </div>
    </div>
    
    <div class="countdown-timer" id="countdownTimer">0</div>
  </div>

  <!-- Footer navigation -->
  <div class="footer-nav">
    <img src="https://i.postimg.cc/ZRr4vff0/Group-271304.png" alt="Tasks" id="tasksIcon" onclick="goToTasks()">
    <img src="https://i.postimg.cc/VsrXpXJv/Group-271303.png" alt="Home" id="homeIcon" class="active" onclick="goToHome()">
    <img src="https://i.postimg.cc/nzqhggK3/Group-271305.png" alt="Rating" id="ratingIcon" onclick="goToRating()">
  </div>

  <!-- Telegram Web App integration -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    let balance = 0;
    let taps = 0;
    const maxTaps = 100;
    let cooldownEndTime = null;
    const cooldownDuration = 24 * 60 * 60 * 1000; // 24 hours in milliseconds

    // Load data from local storage on page load
    window.onload = function() {
      loadDataFromLocalStorage();
      fetchUserData();
      checkCooldown();
    }

    function loadDataFromLocalStorage() {
      if (localStorage.getItem('balance')) {
        balance = parseInt(localStorage.getItem('balance'), 10);
        document.getElementById('balance').textContent = balance;
      }

      if (localStorage.getItem('taps')) {
        taps = parseInt(localStorage.getItem('taps'), 10);
        updateProgressBar();
      }

      if (localStorage.getItem('cooldownEndTime')) {
        cooldownEndTime = parseInt(localStorage.getItem('cooldownEndTime'), 10);
      }
    }

    // Function to update the balance with tap effect
    document.getElementById("imageContainer").addEventListener("click", function() {
      if (taps < maxTaps) {
        balance += 1;
        taps += 1;
        document.getElementById("balance").textContent = balance;
        updateProgressBar();
        
        // Create an image element
const flyOutImage = document.createElement('img');
flyOutImage.src = 'https://i.postimg.cc/L6Jfn0Ns/Background-Eraser-20240922-084932275.png'; // Replace with your desired image path

flyOutImage.classList.add('fly-out');
flyOutImage.style.width = '100px';
flyOutImage.style.height = '100px';
flyOutImage.style.left = (Math.random() * 80) + '%';

document.body.appendChild(flyOutImage);

setTimeout(() => {
  flyOutImage.remove();
}, 1500);


        // Store the updated balance and taps in localStorage
        localStorage.setItem("balance", balance);
        localStorage.setItem("taps", taps);
      }
    });

    // Function to update the progress bar
    function updateProgressBar() {
      const progressPercentage = (taps / maxTaps) * 100;
      document.getElementById("progressBar").style.width = progressPercentage + "%";
      document.getElementById("progressText").textContent = taps + " / " + maxTaps;
    }

    // Function to display fly-out effect for +1
    function flyOut(value) {
      const flyOutElement = document.createElement("div");
      flyOutElement.textContent = value;
      flyOutElement.classList.add("fly-out");
      document.body.appendChild(flyOutElement);

      // Remove the element after animation ends
      setTimeout(() => {
        flyOutElement.remove();
      }, 1000);
    }

    // Function to go to the Tasks page
    function goToTasks() {
      window.location.href = "tasks.html";
    }

    // Function to go to the Home page
    function goToHome() {
      // Already on the home page
    }

    // Function to go to the Rating page
    function goToRating() {
      window.location.href = "rating.html";
    }

    // Function to handle the cooldown and reset taps after 24 hours
    function checkCooldown() {
      const now = new Date().getTime();

      if (cooldownEndTime && now >= cooldownEndTime) {
        resetTaps();
      } else if (cooldownEndTime) {
        const remainingTime = cooldownEndTime - now;
        startCountdownTimer(remainingTime);
      }
    }

    function resetTaps() {
      taps = 0;
      updateProgressBar();
      localStorage.setItem("taps", taps);

      const now = new Date().getTime();
      cooldownEndTime = now + cooldownDuration;
      localStorage.setItem("cooldownEndTime", cooldownEndTime);

      startCountdownTimer(cooldownDuration);
    }

    function startCountdownTimer(duration) {
      const countdownElement = document.getElementById('countdownTimer');
      let timeRemaining = duration / 1000; // Convert to seconds

      const countdownInterval = setInterval(() => {
        if (timeRemaining <= 0) {
          clearInterval(countdownInterval);
          countdownElement.textContent = 'Taps Reset!';
          resetTaps();
        } else {
          const hours = Math.floor(timeRemaining / 3600);
          const minutes = Math.floor((timeRemaining % 3600) / 60);
          const seconds = Math.floor(timeRemaining % 60);
          countdownElement.textContent = `Next tap reset: ${hours}h ${minutes}m ${seconds}s`;
          timeRemaining--;
        }
      }, 1000);
    }

    // Function to fetch and display Telegram user data
    function fetchUserData() {
      const tg = window.Telegram.WebApp;

      if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
        const user = tg.initDataUnsafe.user;
        document.getElementById('balance').textContent = `${balance}`;
      }
    }
  </script>
</body>
</html>
